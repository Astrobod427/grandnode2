services:
    grandnode_web:
        build:
            context: .
            dockerfile: Dockerfile.GrandNodeDev # Utilise le nouveau fichier crÃ©Ã©
        container_name: grandnode_dev

        ports:
            # Port d'accÃ¨s pour GrandNode
            - "5011:8080"

        environment:
            ASPNETCORE_ENVIRONMENT: Development
            # Connexion au service MongoDB
            ConnectionStrings__MongoDbConnection: mongodb://mongodb-server:27017/grandnode-data
            DOTNET_CLI_TELEMETRY_OPTOUT: "true"
            DOTNET_SKIP_FIRST_TIME_EXPERIENCE: "true"

        volumes:
            # Montage du code source de GrandNode
            - .:/app
            - ~/.nuget/packages:/root/.nuget/packages:ro
            # Isolation des dossiers de build
            - /app/src/Web/Grand.Web/bin
            - /app/src/Web/Grand.Web/obj
            - /root/.dotnet

        # ðŸ’¥ COMMANDE CLÃ‰ : Utilisation du chemin exact du projet GrandNode
        command: [
            "dotnet",
            "watch",
            "--project", "src/Web/Grand.Web/Grand.Web.csproj",
            "run",
            "--urls", "http://0.0.0.0:8080",
            "--no-launch-profile"
        ]

        networks:
          - dev_services_network

networks:
  dev_services_network:
    external: true
